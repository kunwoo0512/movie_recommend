# 연구 배경
 기존 OTT 서비스의 경우 블랙박스 알고리즘을 사용하여 내부적인 동작 방식은 숨긴 채 사
용자들에게 영화를 추천해준다. 사용자는 본인이나 다른 사용자들의 시청 이력, 평점, 장르 등
의 데이터를 기반으로 추천된다는 것을 지레 짐작만 할 수 있을 뿐 알고리즘이 어떤 방식으로
작동하는지, 결과물이 왜 추천되었는지 알 수 있는 방법이 없으므로 추천에 대한 이유 설명이
부족하다는 단점이 존재한다. 

 또 대부분의 OTT 서비스들이 협업 필터링 방식을 사용하여 추천하는 방식도 사용하고 있는
데, 협업 필터링 방식은 특정 사용자가 본 영화와 비슷한 영화를 본 다른 사용자들의 데이터
를 활용하여 추천하는 방식이다. 그러나 이런 협업 필터링 방식은 기존 사용자들의 시청 기록을 필
요로 하기 때문에 개봉한지 얼마 안되어서 시청 기록이 부족한 신규 영화나 인지도가 없어 시
청 기록이 부족한 영화들의 경우 추천되지 않을 수 있다는 ‘콜드 스타트’문제가 발생할 수 있다.

# 세부 내용
본 프로젝트는 영화의 줄거리와 서사의 흐름을 함께 고려하여, 사용자의 검색어에 맞는 영화를 벡터 유사도 기반으로 추천하는 시스템을 개발하는 것을 목표로 한다. 단순 키워드 매칭이 아닌 의미적·문맥적 검색을 가능하게 하고, 추천 이유와 영화의 전체적인 흐름을 함께 보여주는 새로운 형태의 영화 추천 서비스 개발을 목표로 한다. 영화 줄거리 데이터를 임베딩하여 구축한 벡터 DB를 통해 이러한 목표를 달성할 수 있을 것으로 보았다. 
 또한 단순히 영화를 추천하는 것 뿐만 아니라 왜 추천되었는지 설명과 그에 관련된 수치 데이터를 명확히 제공함으로써 사용자로 하여금 해당 영화를 추천한 이유를 납득 가능하도록 하는 것을 목표로 한다. LLM 분석을 통하여 사용자에게 설득력을 더할 수 있을 것으로 보았다.

 우선 벡터 DB를 구축하기 위한 데이터셋을 준비하였다. 영화 데이터셋(제목, 연도, 감독, 장르, 줄거리, 흐름 곡선)을 수집하고, 이를 임베딩하여 벡터 DB에 저장한다. 제목, 장르, 연도, 감독 데이터는 OMDB, TMDB API를 활용하여 수집하였고 줄거리 데이터는 Wikipidia API를 활용하여 추출하였다. OpenAI api를 활용한 LLM 분석을 통해 수집한 줄거리 데이터를 10개의 구간으로 나누어 흐름 곡선을 생성하였다. 최종적으로 생성한 데이터셋은 영화 제목, 연도, 감독, 장르, 줄거리, 흐름 곡선으로 구성된다.
 줄거리 텍스트는 통째로 임베딩할 경우 노이즈가 발생하고 Sentence-BERT가 문맥을 파악하지 못할 확률이 높으므로 200~300토큰 단위로 chunking후 각각의 chunk된 줄거리를 임베딩하는 방식을 사용하였다. Sentence-BERT(SBERT) 모델이 문장의 문맥을 파악하는데 가장 강점이 있기 때문에 핵심 임베딩 기술로 사용하였다. 이는 sentence-transformers 라이브러리를 통해 구현하였

실제 서비스에서는 사용자가 영화의 줄거리와 관련된 검색어를 입력하면 사용자가 입력한 검색어와 유사한 줄거리를 가진 영화들을 벡터 데이터베이스에서 찾아 검색 결과로 반환한다. 상위 20개 영화를 반환하며 해당 영화들은 LLM 분석을 통해서 검색어와 어울리는 결과인지 2차적인 검증을 거친 다음 사용자에게 보여진다. LLM 분석은 OpenAI GPT-3.5-turbo API를 연동하여 영화 추천 이유에 대한 설명을 생성하며, 이를 통해 사용자에게 투명하고 이해 가능한 추천 근거를 제공한다.

검색 결과로 나온 영화의 포스터를 클릭하면 상세 정보 페이지로 이동한다. 영화의 포스터, 제목, 감독, 개봉 연도, 줄거리 등의 상세 정보를 볼 수 있는 페이지이다. LLM 분석 점수와 왜 추천되었는지 설명도 볼 수 있도록 하였다. 상세 정보 페이지의 하단부에서는 해당 영화와 관련된 영화들을 추천해주며 줄거리, 흐름곡선, 장르의 유사도를 기준으로 추천된다. 사용자는 유사도를 측정할 때 줄거리, 흐름곡선, 장르의 비중을 각각 어느정도로 둘 것인지 조절이 가능하며 변경 버튼을 누르면 새롭게 변경된 수치로 다시 관련 영화를 추천해주도록 구현하였다.
 
관련 영화 중 하나를 선택하면 현재 영화와 관련 영화의 데이터를 비교할 수 있는 비교/분석 페이지로 이동한다. 페이지 상단에서는 영화 포스터, 제목, 감독, 개봉 연도, 해당 영화의 장르 3가지에 대한 정보를 확인할 수 있다. 또한 두 영화간의 줄거리, 흐름곡선, 장르의 유사도가 어느정도인지 수치를 확인할 수 있다. 흐름 곡선은 영화의 긴장도를 1에서 10까지의 점수로 나타내는데, 일상적인 장면은 긴장도가 떨어지므로 낮은 점수일 것이고 영화의 하이라이트 부분은 높은 점수가 측정될 것이다. 두 영화의 흐름 곡선의 비교를 통해 영화의 전체적인 흐름이 어떤식으로 비슷하고 다른지 확인할 수 있으며 그 아래에는 흐름 곡선의 각 구간에 대한 간략한 요약을 통해 사용자에게 왜 이런 데이터가 나왔는지 설득력을 높이려고 하였다. 마지막으로 LLM 분석을 통해 관련 영화로 추천된 이유도 사용자에게 설명하도록 구현하였다. 

# 검색 결과 예시
<img width="569" height="272" alt="image" src="https://github.com/user-attachments/assets/514ef419-3f14-4619-87c9-16d9bc84358d" />


# 영화 상세 정보 페이지 예시
<img width="569" height="295" alt="image" src="https://github.com/user-attachments/assets/12af1c4c-1072-47a3-913f-4deef5c3f39d" />
<img width="569" height="285" alt="image" src="https://github.com/user-attachments/assets/930dc3f6-46dc-4251-b4ef-ab5fd304ed31" />
<img width="569" height="178" alt="image" src="https://github.com/user-attachments/assets/e43d7eb4-905e-46a0-96b9-a45df3aa7d24" />


# 비교/분석 페이지 예시
<img width="569" height="254" alt="image" src="https://github.com/user-attachments/assets/ee7146cd-227c-4a18-99a3-43b17dd39886" />
<img width="569" height="255" alt="image" src="https://github.com/user-attachments/assets/bd56d0f6-1a72-4151-bd1f-524e41e98710" />
<img width="569" height="255" alt="image" src="https://github.com/user-attachments/assets/552a547e-ef34-4744-a298-c14e628c0948" />
<img width="569" height="193" alt="image" src="https://github.com/user-attachments/assets/9af37256-1dbe-4864-bf5e-85ce439c19e2" />
<img width="569" height="101" alt="image" src="https://github.com/user-attachments/assets/4deec5b2-5f2b-4c53-9d98-2b7340cc890c" />


# 결론
Sentence-BERT 모델을 활용한 줄거리 임베딩을 통해 사용자의 의미적·문맥적 검색어에 대응하는 영화 추천이 가능해졌다. 일례로 "꿈과 현실을 오가는 영화"와 같은 다소 추상적인 검색어도 효과적으로 처리하여 검색 결과로 메트릭스, 인셉션 등의 영화를 반환하는 것을 확인하였다. 또한 설득력을 높이기 위해 추천 이유를 제공하여 사용자의 이해도와 신뢰도를 향상시켰다. 
